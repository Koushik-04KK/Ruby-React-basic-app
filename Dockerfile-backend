# Use the official Ruby image as the base
FROM ruby:3.2.0-slim

# Set the working directory inside the container
WORKDIR /usr/src/app

# Install PostgreSQL client libraries (required by the 'pg' gem)
RUN apt-get update -qq && apt-get install -y build-essential libpq-dev

# Copy the Gemfile and Gemfile.lock (if you had one, highly recommended)
# We copy only these files first to leverage Docker caching
COPY backend/Gemfile .

# Install dependencies
RUN bundle install

# Copy the rest of the application code
COPY backend/ .

# Expose the port Sinatra runs on (default is 4567)
EXPOSE 4567

# The default command to run the app
CMD ["ruby", "app.rb"]